<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ¤ç‰©ã®åˆ†é¡ã‚ã‘ã‚¯ã‚¤ã‚ºã‚²ãƒ¼ãƒ </title>
  <style>
    body {
      touch-action: manipulation;
      background-color: black;
      color: white;
      font-family: 'Press Start 2P', monospace;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    #gameContainer {
      width: 90vw;
      max-width: 100vw;
      height: auto;
      background-color: black;
      color: white;
      text-align: center;
      margin: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }
    .dq-frame {
      border: 3px double white;
      background-color: black;
      color: white;
      padding: 8px;
      margin: 10px auto;
      box-sizing: border-box;
    }
    .button {
      background-color: black;
      border: 2px solid white;
      color: white;
      padding: 8px 12px;
      margin: 5px;
      cursor: pointer;
      font-family: 'Press Start 2P', monospace;
      font-size: 14px;
    }
    .button:hover {
      background-color: white;
      color: black;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="startScreen" class="dq-frame">
      <button id="startButton" class="button">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>
    
    <div id="gameScreen" style="display: none;">
      <div id="messageBox" class="dq-frame"></div>
      <div>
        <span>BGMã®æœ‰ç„¡: </span>
        <button id="muteButton" class="button">éŸ³ ON</button>
      </div>
      <div id="endScreen" class="dq-frame" style="display: none;">
        <button id="mouthButton" class="button">â–¶ãã¡ã¶ãˆ</button>
      </div>
    </div>
  </div>
  
  <!-- BGM & åŠ¹æœéŸ³ -->
  <audio id="bgm" src="https://kogkoba.github.io/bunrui/sciencebgm.mp3" loop></audio>
  <audio id="dqWinSound" src="https://kogkoba.github.io/bunruiq4i/DQwin.mp3"></audio>
  <audio id="dqDownSound" src="https://kogkoba.github.io/bunruiq4i/DQdown.mp3"></audio>

  <script>
    const startScreen = document.getElementById("startScreen");
    const startButton = document.getElementById("startButton");
    const gameScreen = document.getElementById("gameScreen");
    const messageBox = document.getElementById("messageBox");
    const mouthButton = document.getElementById("mouthButton");
    const endScreen = document.getElementById("endScreen");
    const bgm = document.getElementById("bgm");
    const dqWinSound = document.getElementById("dqWinSound");
    const dqDownSound = document.getElementById("dqDownSound");
    const muteButton = document.getElementById("muteButton");

    // ğŸ”Š ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰BGMã®ãƒŸãƒ¥ãƒ¼ãƒˆè¨­å®šã‚’å–å¾—
    let isMuted = localStorage.getItem("bgmMuted") === "true";
    bgm.muted = isMuted;
    muteButton.textContent = isMuted ? "éŸ³ ON" : "éŸ³ OFF";

    // ğŸ”‡ ãƒŸãƒ¥ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã®åˆ‡ã‚Šæ›¿ãˆå‡¦ç†
    muteButton.addEventListener("click", () => {
      bgm.muted = !bgm.muted;
      localStorage.setItem("bgmMuted", bgm.muted);
      muteButton.textContent = bgm.muted ? "éŸ³ ON" : "éŸ³ OFF";
      if (!bgm.muted) {
        bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      }
    });

    // ğŸ® ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ï¼ˆã‚²ãƒ¼ãƒ é–‹å§‹ï¼‰
    startButton.addEventListener("click", startGame);

    // ğŸ”„ ãã¡ã¶ãˆãƒœã‚¿ãƒ³ï¼ˆãƒªã‚»ãƒƒãƒˆï¼‰
    mouthButton.addEventListener("click", () => {
      stopAllSounds();
      location.reload();
    });

    function startGame() {
      startScreen.style.display = "none";
      gameScreen.style.display = "block";
      if (!bgm.muted) {
        bgm.play().catch(error => console.error("BGMå†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      }
      nextQuestion();
    }

    function nextQuestion() {
      messageBox.innerText = "æ¤ç‰©ãŒã€€ã‚ã‚‰ã‚ã‚ŒãŸã€‚";
      setTimeout(() => {
        messageBox.innerText = "æ¤ç‰©ã¯ â—‹â—‹â—‹ ã‚’ã€€ãã‚Šã ã—ãŸã€‚";
      }, 400);
    }

    function checkGameOver(playerLost) {
      // ğŸµ BGMã‚’åœæ­¢ã—ã¦æœ€åˆã«æˆ»ã™
      bgm.pause();
      bgm.currentTime = 0;

      // ğŸ¶ é©åˆ‡ãªåŠ¹æœéŸ³ã‚’å†ç”Ÿ
      if (playerLost) {
        messageBox.innerText = "ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã€€ãŸãŠã‚ŒãŸã€‚";
        dqDownSound.play().catch(error => console.error("éŸ³ã®å†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      } else {
        messageBox.innerText = "æ¤ç‰©ã¯ã€€ãŸãŠã‚ŒãŸã€‚";
        dqWinSound.play().catch(error => console.error("éŸ³ã®å†ç”Ÿã‚¨ãƒ©ãƒ¼:", error));
      }

      // ğŸ® ç”»é¢ã®æ›´æ–°
      endScreen.style.display = "block";
    }

    function stopAllSounds() {
      bgm.pause();
      bgm.currentTime = 0;
      dqWinSound.pause();
      dqWinSound.currentTime = 0;
      dqDownSound.pause();
      dqDownSound.currentTime = 0;
    }
  </script>
</body>
</html>
